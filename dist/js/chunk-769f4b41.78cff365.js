(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-769f4b41"],{e01c:function(e,t,a){"use strict";a("ec07")},ec07:function(e,t,a){},f127:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"home-wrapper"},[a("el-button",{staticClass:"btn-add",attrs:{type:"primary"},on:{click:function(t){return e.addPrimarymenu()}}},[e._v("新增章节")]),a("div",{staticClass:"newContent"},[a("el-table",{attrs:{data:e.menuList}},[a("el-table-column",{attrs:{width:"100px",type:"index",align:"center",label:"序号"}}),a("el-table-column",{attrs:{width:"200px",align:"center",prop:"chapter",label:"章名称"}}),a("el-table-column",{attrs:{width:"200px",align:"center",prop:"section",label:"节名称"}}),a("el-table-column",{attrs:{width:"200px",align:"center",prop:"courseUrl",label:"视频链接"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{underline:!1,href:t.row.courseUrl}},[e._v(e._s(t.row.courseUrl))])]}}])}),a("el-table-column",{attrs:{prop:"action",label:"操作",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"text-link",on:{click:function(a){return e.modifyMenu(t.row)}}},[e._v("修改")]),a("span",{staticClass:"text-link",on:{click:function(a){return e.delMenu(t.row.id)}}},[e._v("删除")])]}}])})],1),0!==e.pageTotal?a("div",{staticClass:"page-box"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.pageTotal,"current-page":e.pageNumber,"page-size":e.pageSize},on:{"current-change":e.handleCurrentPageChange,"update:currentPage":function(t){e.pageNumber=t},"update:current-page":function(t){e.pageNumber=t}}})],1):e._e()],1),[a("el-dialog",{attrs:{title:e.menuTitle,visible:e.addPrimarymenuVisible,"modal-append-to-body":!1,width:"500px"},on:{"update:visible":function(t){e.addPrimarymenuVisible=t}}},[a("el-form",{ref:"menu_form",attrs:{model:e.menu_form,rules:e.rulePrimary}},[a("el-form-item",{attrs:{label:"节名","label-width":"120px",prop:"section"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.menu_form.section,callback:function(t){e.$set(e.menu_form,"section",t)},expression:"menu_form.section"}})],1),a("el-form-item",{attrs:{label:"章","label-width":"120px",prop:"teacher"}},[a("el-radio",{attrs:{label:"1"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("新增章")]),e.chapterList.length>0?a("el-radio",{attrs:{label:"2"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("选择已有章")]):e._e()],1),a("el-form-item",{attrs:{label:"章节名称","label-width":"120px",prop:"chapter"}},[1==e.radio?a("el-input",{model:{value:e.menu_form.chapter,callback:function(t){e.$set(e.menu_form,"chapter",t)},expression:"menu_form.chapter"}}):e._e(),2==e.radio?a("el-cascader",{attrs:{options:e.chapterList,"show-all-levels":!1},on:{change:e.handleChange},model:{value:e.menu_form.chapter,callback:function(t){e.$set(e.menu_form,"chapter",t)},expression:"menu_form.chapter"}}):e._e()],1),"修改章节"!=e.menuTitle?a("el-form-item",{attrs:{label:"视频","label-width":"120px",prop:"course_url"}},[a("el-upload",{staticClass:"upload-demo",attrs:{multiple:"",action:"",limit:1,accept:".mp4,MP4,.wmv",disabled:e.isDisabledUrl,"before-upload":e.beforeAvatarUploadUrl,"http-request":e.handleUploadUrl}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e.percentageUrl<100&&e.percentageUrl>0?a("el-progress",{attrs:{percentage:e.percentageUrl}}):e._e(),100==e.percentageUrl?a("el-progress",{attrs:{percentage:e.percentageUrl,status:"success"}}):e._e()],1)],1):e._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addPrimarymenuVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitmenu_form("menu_form")}}},[e._v("确 定")])],1)],1)]],2)},n=[],i=(a("159b"),a("b0c0"),a("a474")),o=a("587c"),l=a.n(o),s={data:function(){return{pageLoading:!1,menuList:[],totalList:[],chapterList:[],menu_form:{course_url:"",section:"",chapter:""},rulePrimary:{section:[{required:!0,message:"请输入内容",trigger:"blur"}],chapter:[{required:!0,message:"请输入内容",trigger:"blur"}]},addPrimarymenuVisible:!1,menuTitle:"添加课程",percentage:0,percentageUrl:0,originName:"",originSize:"",uploadFail:!1,uploadFailUrl:!1,isDisabled:!1,isDisabledUrl:!1,isLoad:0,radio:"1",pageTotal:0,pageNumber:1,pageSize:10}},mounted:function(){this.getMenuList(),this.getChapterList()},methods:{getMenuList:function(){var e=this;Object(i["j"])({id:this.$route.query.id}).then((function(t){e.pageTotal=t.length;for(var a=[],r=0;r<t.length;r++)r%10==0&&(e.totalList.push(a),a=[]),a.push(t[r]);a.length>0&&e.totalList.push(a),e.menuList=e.totalList[1]}))},handleCurrentPageChange:function(e){this.menuList=this.totalList[e]},getChapterList:function(){var e=this;Object(i["f"])({id:this.$route.query.id}).then((function(t){t.length>0&&t.forEach((function(e){e.label=e.chapter,e.value=e.chapter})),e.chapterList=t}))},handleChange:function(e){this.menu_form.chapter=e[e.length-1]},addPrimarymenu:function(){this.menuTitle="新增课程",this.menu_form.section="",this.menu_form.chapter="",this.menu_form.course_url="",this.addPrimarymenuVisible=!0},submitmenu_form:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;if("新增课程"==t.menuTitle){if(t.menu_form.course_id=t.$route.query.id,""==t.menu_form.course_url)return t.$message.error("未上传视频"),!1;Object(i["p"])(t.menu_form).then((function(e){t.$message.success("新增成功"),t.getMenuList(),t.getChapterList(),t.addPrimarymenuVisible=!1}))}else Object(i["m"])(t.menu_form).then((function(e){t.$message.success("更新成功"),t.getMenuList(),t.getChapterList(),t.addPrimarymenuVisible=!1}))}))},delMenu:function(e){var t=this;this.$confirm("确定要删除吗？ 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["c"])({id:e}).then((function(e){t.$message.success("删除成功"),t.getMenuList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},modifyMenu:function(e){this.menu_form.id=e.id,this.menuTitle="修改章节",this.menu_form.section=e.section,this.menu_form.chapter=e.chapter,this.addPrimarymenuVisible=!0},handleUploadUrl:function(e){var t=this,a=e.file;if(a){this.originName=a.name,this.originSize=a.size;var r=new l.a({SecretId:"AKIDJMAi01oGSOJ0RUAwIWXZR4QWLvEInxSi",SecretKey:"MtUpxsY7RdaIju23oKgmcokqhHo67C3h"});r.putObject({Bucket:"examplecourse-1304676805",Region:"ap-chengdu",Key:"course/".concat(this.originName),Body:a,onProgress:function(e){t.percentageUrl=parseInt(100*e.percent),t.isDisabledUrl=!0}},(function(e,a){console.log(e||a),a&&a.Location&&200==a.statusCode&&(t.menu_form.course_url="https://".concat(a.Location),t.isLoad=1),e&&layer.msg("上传文件失败",{icon:2,time:1200,shade:.5}),t.isDisabledUrl=!1,t.uploadFailUrl=!0}))}},beforeAvatarUploadUrl:function(e){this.uploadFile=e,this.uploadFileName=e.name;var t=e.size/1024/1024<=102400;return t||this.$message.error("上传文件大小不能超过 1GB!"),t}}},u=s,c=(a("e01c"),a("2877")),m=Object(c["a"])(u,r,n,!1,null,null,null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-769f4b41.78cff365.js.map